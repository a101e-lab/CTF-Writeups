from pwn import *

r = remote('34.123.210.162', 20231)
# r = process('./re3.bin_no_alarm')
# gdb.attach(r, 'b *(configure_username+128)')
r.recvuntil(b'Options: (1) Enter username, (2) Confirm username, (3) Done: ')
r.sendline(b'2')
raw_code = r.recvline()
raw_code = raw_code.split(b':')[-1].strip()
auth_code = int.from_bytes(raw_code, 'little')
print(raw_code)
r.recvuntil(b'Options: (1) Enter username, (2) Confirm username, (3) Done: ')
r.sendline(b'1')
r.recvuntil(b'Username: ')
r.sendline(b'admin')
r.recvuntil(b'Options: (1) Enter username, (2) Confirm username, (3) Done: ')
r.sendline(b'3')
r.recvuntil(b'Enter your authentication code: ')
r.sendline(str(auth_code).encode())
r.interactive()